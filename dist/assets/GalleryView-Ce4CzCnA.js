import{T as h,bP as $,j as y,t as u,d5 as D,d6 as R,br as V,ao as O,aq as P,d7 as E,d8 as k,d9 as q,da as G,db as K,aN as N,bb as W,dc as z,dd as B,de as F,X as H,ap as M,bu as X,df as U}from"./index-DMLId2Bo.js";import{d as Y}from"./WorkspaceArea-Bm7_wBIo.js";function J(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}function L(t,e){for(var r=0;r<e.length;r++){var n=e[r];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(t,_(n.key),n)}}function Q(t,e,r){return e&&L(t.prototype,e),Object.defineProperty(t,"prototype",{writable:!1}),t}function Z(t,e,r){return e=p(e),ee(t,j()?Reflect.construct(e,r||[],p(t).constructor):e.apply(t,r))}function ee(t,e){if(e&&(typeof e=="object"||typeof e=="function"))return e;if(e!==void 0)throw new TypeError("Derived constructors may only return object or undefined");return f(t)}function j(){try{var t=!Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],function(){}))}catch{}return(j=function(){return!!t})()}function p(t){return p=Object.setPrototypeOf?Object.getPrototypeOf.bind():function(r){return r.__proto__||Object.getPrototypeOf(r)},p(t)}function f(t){if(t===void 0)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return t}function te(t,e){if(typeof e!="function"&&e!==null)throw new TypeError("Super expression must either be null or a function");t.prototype=Object.create(e&&e.prototype,{constructor:{value:t,writable:!0,configurable:!0}}),Object.defineProperty(t,"prototype",{writable:!1}),e&&w(t,e)}function w(t,e){return w=Object.setPrototypeOf?Object.setPrototypeOf.bind():function(n,o){return n.__proto__=o,n},w(t,e)}function g(t,e){var r=Object.keys(t);if(Object.getOwnPropertySymbols){var n=Object.getOwnPropertySymbols(t);e&&(n=n.filter(function(o){return Object.getOwnPropertyDescriptor(t,o).enumerable})),r.push.apply(r,n)}return r}function v(t){for(var e=1;e<arguments.length;e++){var r=arguments[e]!=null?arguments[e]:{};e%2?g(Object(r),!0).forEach(function(n){ne(t,n,r[n])}):Object.getOwnPropertyDescriptors?Object.defineProperties(t,Object.getOwnPropertyDescriptors(r)):g(Object(r)).forEach(function(n){Object.defineProperty(t,n,Object.getOwnPropertyDescriptor(r,n))})}return t}function ne(t,e,r){return e=_(e),e in t?Object.defineProperty(t,e,{value:r,enumerable:!0,configurable:!0,writable:!0}):t[e]=r,t}function _(t){var e=re(t,"string");return typeof e=="symbol"?e:String(e)}function re(t,e){if(typeof t!="object"||!t)return t;var r=t[Symbol.toPrimitive];if(r!==void 0){var n=r.call(t,e||"default");if(typeof n!="object")return n;throw new TypeError("@@toPrimitive must return a primitive value.")}return(e==="string"?String:Number)(t)}var oe=h("div",{name:"GalleryView",slot:"thumbnail"})(function(t){var e=t.ownerState,r=t.theme;return v(v(v({"&:focus":{outline:"none"},"&:hover":{backgroundColor:r.palette.action.hover},border:"2px solid transparent"},e.selected&&{borderColor:r.palette.primary.main}),!e.selected&&e.searchAnnotationsCount>0&&{borderColor:r.palette.action.selected}),{},{cursor:"pointer",display:"inline-block",margin:r.spacing(1,.5),maxHeight:e.config.height+45,minWidth:"60px",overflow:"hidden",padding:r.spacing(.5),position:"relative",width:"min-content"})}),ie=h("div",{name:"GalleryView",slot:"chipArea"})(function(t){var e=t.theme;return{display:"flex",flexDirection:"column",gap:e.spacing(.25),position:"absolute",right:0,top:0}}),m=h($,{name:"GalleryView",slot:"chip"})(function(t){var e=t.theme;return{backgroundColor:e.palette.annotations.chipBackground,opacity:.875,textAlign:"right"}}),C=function(t){te(e,t);function e(r){var n;return J(this,e),n=Z(this,e,[r]),n.myRef=y.createRef(),n.state={requestedAnnotations:!1},n.handleSelect=n.handleSelect.bind(f(n)),n.handleKey=n.handleKey.bind(f(n)),n.handleIntersection=n.handleIntersection.bind(f(n)),n}return Q(e,[{key:"componentDidMount",value:function(){var n=this.props.selected;if(n){var o;(o=this.myRef.current)===null||o===void 0||o.scrollIntoView(!0)}}},{key:"handleSelect",value:function(){var n=this.props,o=n.canvas,a=n.selected,i=n.setCanvas,s=n.focusOnCanvas;a?s():i(o.id)}},{key:"handleKey",value:function(n){var o=this.props,a=o.canvas,i=o.setCanvas,s=o.focusOnCanvas;this.keys={enter:"Enter",space:" "},this.chars={enter:13,space:32};var c=n.key===this.keys.enter||n.which===this.chars.enter||n.key===this.keys.space||n.which===this.chars.space;c?s():i(a.id)}},{key:"handleIntersection",value:function(n,o){var a=o.isIntersecting,i=this.props,s=i.annotationsCount,c=i.requestCanvasAnnotations,l=this.state.requestedAnnotations;!a||s===void 0||s>0||l||(this.setState({requestedAnnotations:!0}),c())}},{key:"render",value:function(){var n=this.props,o=n.annotationsCount,a=n.searchAnnotationsCount,i=n.canvas,s=n.config,c=n.selected;return u.jsx(D,{onChange:this.handleIntersection,children:u.jsx(oe,{ownerState:this.props,className:c?"selected":"",onClick:this.handleSelect,onKeyUp:this.handleKey,ref:this.myRef,role:"button",tabIndex:0,children:u.jsx(R,{resource:i,labelled:!0,variant:"outside",maxHeight:s.height,maxWidth:s.width,children:u.jsxs(ie,{children:[a>0&&u.jsx(m,{icon:u.jsx(V,{fontSize:"small"}),label:a,size:"small"}),o>0&&u.jsx(m,{icon:u.jsx(Y,{fontSize:"small"}),label:o,size:"small"})]})})},i.id||i.index)})}}]),e}(y.Component);C.defaultProps={annotationsCount:void 0,config:{height:100,width:null},requestCanvasAnnotations:function(){},searchAnnotationsCount:0,selected:!1};var ae=function(e,r){var n=r.canvas,o=r.windowId,a=E(e,{windowId:o}),i=k(e,{windowId:o}),s=q(i.map(function(l){return l.resources})).filter(function(l){return l.targetId===n.id}),c=G(e,{content:"annotations",windowId:o}).length>0;return{annotationsCount:function(){if(c){var l=K(e,{canvasId:n.id});return l.reduce(function(S,A){return S+A.resources.filter(function(T){return T.targetId===n.id}).length},0)}}(),config:N(e).galleryView,searchAnnotationsCount:s.length,selected:a&&a.id===n.id}},se=function(e,r){var n=r.canvas;r.id;var o=r.windowId;return{focusOnCanvas:function(){return e(W(o,"single"))},requestCanvasAnnotations:function(){return e(z(o,n.id))},setCanvas:function(){for(var i=arguments.length,s=new Array(i),c=0;c<i;c++)s[c]=arguments[c];return e(B.apply(F,[o].concat(s)))}}},ce=O(P(ae,se));const ue=ce(C);function le(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}function fe(t,e){for(var r=0;r<e.length;r++){var n=e[r];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(t,de(n.key),n)}}function pe(t,e,r){return e&&fe(t.prototype,e),Object.defineProperty(t,"prototype",{writable:!1}),t}function de(t){var e=he(t,"string");return typeof e=="symbol"?e:String(e)}function he(t,e){if(typeof t!="object"||!t)return t;var r=t[Symbol.toPrimitive];if(r!==void 0){var n=r.call(t,e);if(typeof n!="object")return n;throw new TypeError("@@toPrimitive must return a primitive value.")}return String(t)}function ve(t,e,r){return e=d(e),ye(t,x()?Reflect.construct(e,r||[],d(t).constructor):e.apply(t,r))}function ye(t,e){if(e&&(typeof e=="object"||typeof e=="function"))return e;if(e!==void 0)throw new TypeError("Derived constructors may only return object or undefined");return we(t)}function we(t){if(t===void 0)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return t}function x(){try{var t=!Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],function(){}))}catch{}return(x=function(){return!!t})()}function d(t){return d=Object.setPrototypeOf?Object.getPrototypeOf.bind():function(r){return r.__proto__||Object.getPrototypeOf(r)},d(t)}function be(t,e){if(typeof e!="function"&&e!==null)throw new TypeError("Super expression must either be null or a function");t.prototype=Object.create(e&&e.prototype,{constructor:{value:t,writable:!0,configurable:!0}}),Object.defineProperty(t,"prototype",{writable:!1}),e&&b(t,e)}function b(t,e){return b=Object.setPrototypeOf?Object.setPrototypeOf.bind():function(n,o){return n.__proto__=o,n},b(t,e)}var ge=h(H,{name:"GalleryView",slot:"root"})(function(t){return t.theme,{alignItems:"flex-start",display:"flex",flexDirection:"row",flexWrap:"wrap",overflowX:"hidden",overflowY:"scroll",padding:"50px 0 50px 20px",width:"100%"}}),I=function(t){be(e,t);function e(){return le(this,e),ve(this,e,arguments)}return pe(e,[{key:"render",value:function(){var n=this.props,o=n.canvases,a=n.viewingDirection,i=n.windowId,s=a==="right-to-left"?"rtl":"ltr";return u.jsx(ge,{component:"section","aria-label":"gallery section",dir:s,square:!0,elevation:0,id:"".concat(i,"-gallery"),children:o.map(function(c){return u.jsx(ue,{windowId:i,canvas:c},c.id)})})}}]),e}(y.Component);I.defaultProps={viewingDirection:""};var me=function(e,r){var n=r.windowId;return{canvases:X(e,{windowId:n}),viewingDirection:U(e,{windowId:n})}},Oe=O(P(me),M("GalleryView"));const _e=Oe(I);export{_e as default};
